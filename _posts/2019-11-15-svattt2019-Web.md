---
layout: post
title: TiÃªn tri vÅ© trá»¥ Tráº§n Tiger
subtitle: Pentest Web - PHP Deobfuscate
tags: [ctf,attt2019,web]
image: /img/tran_tiger.png
share-img: /img/tran_tiger.png
---
ChÃ o má»i ngÆ°á»i Ä‘Ã¢y lÃ  post Ä‘áº§u tiÃªn cá»§a mÃ¬nh trÃªn blog. Tháº­t ra thÃ¬ láº§n Ä‘áº§u Ä‘i thi SVATTT2019 cáº£m tháº¥y ráº¥t hÃ o há»©ng, bÃªn cáº¡nh Ä‘Ã³ thÃ¬ cÅ©ng cháº£ biáº¿t khá»‰ gÃ¬ trong Ä‘áº§u, may thay káº¿t thÃºc vÃ²ng loáº¡i, thÃ¬ team mÃ¬nh cÅ©ng cÃ³ cÃ¡i giáº£i lÃ  `giáº£i khuyáº¿n khÃ­ch` :)))

NÃ³i chung lÃ  cáº£ team noob nÃªn Ä‘i Ä‘á»ƒ há»c há»i lÃ  chÃ­nh vÃ  ngáº¯m gÃ¡i SIU lÃ  10, vá» pháº§n mÃ¬nh thÃ¬ thi xong giáº£i Ä‘Ã³ mÃ¬nh cÅ©ng cháº£ giáº£i ra chall nÃ o cáº£, nÃªn vá» nhÃ  hardcore láº¡i vÃ  cÅ©ng tÃ¬m hiá»ƒu Ä‘Ã´i chÃºt pass qua Ä‘Æ°á»£c chal `Tráº§n Tiger` nÃ y.

Nghe báº£o Ä‘Ã¢y cÃ²n lÃ  chall cho Ä‘iá»ƒm ğŸ‘»
Sau khi config docker vÃ  clone tá»« anh `Tsu` thÃ¬ cÅ©ng Ä‘Ã£ gáº·p láº¡i Mr.Tiger 

<img src="/img/15112019/01.png" alt="Config challenge" align="center"/>

NhÃ¬n vÃ o Ä‘á» bÃ i lÃºc Ä‘áº§u cÅ©ng cháº£ hÃ¬nh dung ra gÃ¬, cá»© Ä‘á»c nhá»¯ng cÃ¢u thoáº¡i ná»•i tiáº¿ng cá»§a Mr.Tiger thÃ¬ chá»‰ nháº­n tháº¥y nhá»¯ng file Ä‘Æ°á»£c load tá»« há»‡ thá»‘ng lÃªn url..

<img src="/img/15112019/02.png" alt="Test submit" align="center"/>

Cá»© thá»­ payload liÃªn tá»¥c..
>http://localhost:8004/?tientri=/etc/passwd

>http://localhost:8004/?tientri=../../../../etc/passwd

NhÆ°ng cÅ©ng bá»‹ cháº·n ná»‘t, liÃªn tá»¥c responder `Äá»“ DÃ´ DÄƒn QÃ³a ğŸ˜ ` láº§n Ä‘áº§u pentest cÅ©ng khÃ¡ báº¿ táº¯c nÃªn ngá»“i search má»™t lÃºc thÃ¬ tháº¥y tools [dirsearch](http://https://github.com/maurosoria/dirsearch) Ä‘á»ƒ brute force dir trong site nÃ y, sau khi run xong thÃ¬ nháº­n tháº¥y cÃ³ folder ráº¥t quen Ä‘Ã³ lÃ  `upload`

<img src="/img/15112019/03.png" alt="Dirsearch Brute Force" align="center"/>

Liá»n truy cáº­p vÃ o thÃ¬ cÅ©ng nháº­n tháº¥y cÃ³ thÃªm lá»—i "Directory Listing", rá»“i nháº­n tháº¥y cÃ³ file flag.php click vÃ´ xem bÃ¹m `Flag Cena` 

<img src="/img/15112019/04.png" alt="Upload directory" align="center"/>

Khi xem qua háº¿t cÃ¡c file thÃ¬ cÃ³ tháº¥y file khÃ¡ nghi ngá» lÃ  backdoor.php, thÆ°á»ng thÃ¬ file nÃ y do admin hay attacker Ä‘á»ƒ láº¡i vá»›i má»¥c Ä‘Ã­ch dá»… truy cáº­p Ä‘á»ƒ Ä‘iá»u khiá»ƒn há»‡ thá»‘ng. Truy cáº­p vÃ o thÃ¬ tháº¥y khÃ¡ nhiá»u ğŸ’© theo Ä‘Ãºng nghÄ©a Ä‘en láº«n nghÄ©a bÃ³ng ..

<img src="/img/15112019/05.png" alt="Access backdoor.php" align="center"/>

Sau má»™t há»“i payload cÅ©ng mÃ² ra Ä‘Æ°á»£c má»™t Ä‘á»‘ng source code cháº£ hiá»ƒu gÃ¬

>http://localhost:8004/?tientri=backdoor.php

<img src="/img/15112019/06.png" alt="Payload backdoor.php" align="center"/>

Up source code Ä‘á»ƒ debug váº­y, sau khi setup vá» local cá»§a mÃ¡y thÃ¬ Ä‘i tháº³ng vÃ o source code

<img src="/img/15112019/07.png" alt="Source code" align="center"/>

ThÃ¬ ta tháº¥y tÃ¡c giáº£ Ä‘á»ƒ 2 dÃ²ng code nÃ y nháº±m trÃ¡nh in ra lá»—i nÃªn khÃ´ng debug Ä‘Æ°á»£c nÃªn xÃ³a 2 dÃ²ng code nÃ y Ä‘i..
```php
<?php
error_reporting(0);
@ini_set('display_errors', 0);
?>
```