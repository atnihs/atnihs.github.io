---
layout: post
title: Tiên tri vũ trụ Trần Tiger
subtitle: Pentest Web - PHP Deobfuscate
tags: [ctf,attt2019,web]
image: /img/tran_tiger.png
share-img: /img/tran_tiger.png
---
Chào mọi người đây là post đầu tiên của mình trên blog. Thật ra thì lần đầu đi thi SVATTT2019 cảm thấy rất hào hứng, bên cạnh đó thì cũng chả biết khỉ gì trong đầu, may thay kết thúc vòng loại, thì team mình cũng có cái giải là `giải khuyến khích` :)))

Nói chung là cả team noob nên đi để học hỏi là chính và ngắm gái SIU là 10, về phần mình thì thi xong giải đó mình cũng chả giải ra chall nào cả, nên về nhà hardcore lại và cũng tìm hiểu đôi chút pass qua được chal `Trần Tiger` này.

Nghe bảo đây còn là chall cho điểm 👻
Sau khi config docker và clone từ anh `Tsu` thì cũng đã gặp lại Mr.Tiger 

<img src="/img/15112019/01.png" alt="Config challenge" align="center"/>

Nhìn vào đề bài lúc đầu cũng chả hình dung ra gì, cứ đọc những câu thoại nổi tiếng của Mr.Tiger thì chỉ nhận thấy những file được load từ hệ thống lên url..

<img src="/img/15112019/02.png" alt="Test submit" align="center"/>

Cứ thử payload liên tục..
>http://localhost:8004/?tientri=/etc/passwd

>http://localhost:8004/?tientri=../../../../etc/passwd

Nhưng cũng bị chặn nốt, liên tục responder `Đồ Dô Dăn Qóa 😠` lần đầu pentest cũng khá bế tắc nên ngồi search một lúc thì thấy tools [dirsearch](http://https://github.com/maurosoria/dirsearch) để brute force dir trong site này, sau khi run xong thì nhận thấy có folder rất quen đó là `upload`

<img src="/img/15112019/03.png" alt="Dirsearch Brute Force" align="center"/>

Liền truy cập vào thì cũng nhận thấy có thêm lỗi "Directory Listing", rồi nhận thấy có file flag.php click vô xem bùm `Flag Cena` 

<img src="/img/15112019/04.png" alt="Upload directory" align="center"/>

Khi xem qua hết các file thì có thấy file khá nghi ngờ là backdoor.php, thường thì file này do admin hay attacker để lại với mục đích dễ truy cập để điều khiển hệ thống. Truy cập vào thì thấy khá nhiều 💩 theo đúng nghĩa đen lẫn nghĩa bóng ..

<img src="/img/15112019/05.png" alt="Access backdoor.php" align="center"/>

Sau một hồi payload cũng mò ra được một đống source code chả hiểu gì

>http://localhost:8004/?tientri=backdoor.php

<img src="/img/15112019/06.png" alt="Payload backdoor.php" align="center"/>

Up source code để debug vậy, sau khi setup về local của máy thì đi thẳng vào source code

<img src="/img/15112019/07.png" alt="Source code" align="center"/>

Thì ta thấy tác giả để 2 dòng code này nhằm tránh in ra lỗi nên không debug được nên xóa 2 dòng code này đi..
```php
<?php
error_reporting(0);
@ini_set('display_errors', 0);
?>
```